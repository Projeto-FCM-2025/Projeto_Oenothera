---
title: "Analise_Dados_2023"
author: "Lis Cavalheiro"
output: html_document
date: "2025-11-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introdução

Este relatório apresenta uma análise exploratória dos atributos florais da espécie Oenothera ravanii coletados no ano de 2023.

As variáveis no dataset são:

- id: identificador único
- area: área floral
- tubo: comprimento do tubo floral
- antera: altura da antera
- estigma: altura do estigma
- nsem: número de sementes
- germ: taxa de germinação

# Descrição 

Para as possíveis análises dos dados do presente projeto, vamos carregá-los, separadamente, por ano. Nesse sentido, procuramos maior organização e entendimento dos dados acerca dos atributos morfológicos funcionais das flores da espécie Oenothera ravenii em um prazo de 9 anos. Este arquivo, em especial, trabalha medidas estatísticas dos dados relativos ao ano de 2023 (arquivo: "Dados_Oenothera_2023.csv")

# Carregamento dos dados

```{r}
library(tidyverse) # biblioteca necessária

df <- read.csv("Dados/Dados_Oenothera_2023.csv") # cria o df

head(df) # visualiza os primeiros valores do DataFrame
```

# Verificando se existem dados faltantes

```{r}
glimpse(df) # geral

colSums(is.na(df)) # contagem de NAs por variável
```

A variável "germ" possui 6 valores NA, e a variável "nsem" apresenta zeros que representam ausência de atributo. Vamos manter os zeros em "nsem" e substituir os valores NAs de "germ" por 0, que indica não germinação.


```{r}
df_clean <- df %>%
  mutate(germ = ifelse(is.na(germ), 0, germ)) # troca valores ausentes por 0

colSums(is.na(df_clean)) # verifica se ainda existem NAs
```


# Estatísticas Descritivas

```{r}
summary(df_clean) # descrição geral dos dados

df_clean %>% 
  summarise(
    media_area = mean(area, na.rm = TRUE), # média - área floral
    sd_area = sd(area, na.rm = TRUE), # desvio padrão
    media_tubo = mean(tubo, na.rm = TRUE), # média - comprimento
    media_nsem = mean(nsem, na.rm = TRUE), # média - n. sementes
    media_germ = mean(germ, na.rm = TRUE) # média - germinação
  )
```

# Visualizações

## Distribuição das variáveis

```{r}
library(dplyr) # manipulação de dados
library(tidyr) # transformação de dados largos e longos
library(ggplot2) # confecção de gráficos
```

Nesta etapa, para a confecção dos gráficos de distribuição das variáveis, os nomes das colunas foram alterados para que os labels fiquem mais claros e informativos, além de evitar problemas com acentuação: 

```{r}
# Renomear variáveis sem acentos
df_clean_plot <- df_clean %>%
  rename(
    Area_mm2 = area,
    Comprimento_tubo_mm = tubo,
    Altura_antera_mm = antera,
    Altura_estigma_mm = estigma,
    Numero_sementes = nsem,
    Germinacao = germ
  )

df_clean_plot %>% # conversão para o formato longo
  pivot_longer(
    cols = c(Area_mm2, Comprimento_tubo_mm, Numero_sementes, Germinacao),
    names_to = "Variavel",
    values_to = "Valor"
  ) %>%
    mutate(
    Variavel = recode(
      Variavel,
      "Area_mm2" = "Área da pétala (mm²)",
      "Comprimento_tubo_mm" = "Comprimento do tubo (mm)",
      "Numero_sementes" = "Número de sementes",
      "Germinacao" = "Germinação (%)"
    )
  ) %>%
  ggplot(aes(x = Valor)) + # inicia o gráfico
  geom_histogram(
    bins = 25,
    fill = "#4C72B0",
    color = "white",
    alpha = 0.8
  ) +
  facet_wrap(~ Variavel, scales = "free", ncol = 2) + # um gráfico para cada variável
  labs(
    title = "Distribuição das Variáveis Florais",
    x = "Valor",
    y = "Frequência"
  ) +
  theme_minimal(base_size = 16) +
  theme(
    plot.title = element_text(face = "bold", size = 18, hjust = 0.5),
    strip.text = element_text(size = 15, face = "bold"),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14)
  )

```

- A área floral apresenta, de maneira geral, uma distribuição que se aproxima de uma distribuição normal/simétrica. O mesmo ocorre para os valores do comprimento do tubo. Entretanto, para a taxa de germinação e o número de sementes, as disrtibuições são fortemente assimétricas à direita.


## Relação entre área floral e germinação

Vamos construir um boxplot para visualização das duas variáveis: "Área Floral" e "Germinação"

```{r}
df_clean %>%
  mutate(area_cat = ntile(area, 4)) %>%   # divide em quartis
  ggplot(aes(x = factor(area_cat), y = germ)) +
  geom_boxplot(fill="#4C72B0", alpha=.6) +
  labs(
    x = "Quartil da Área Floral",
    y = "Germinação",
    title = "Germinação por Quartis de Área Floral"
  ) +
  theme_minimal()
```

- Este gráfico compara a distribuição da variável Germinação (no eixo Y) em função dos Quartis da área floral (no eixo X). Cada caixa representa um quarto das observações, ordenadas pelo tamanho da área floral, desde o menor (Quartil 1) até o maior (Quartil 4). A análise dos boxplots sugere uma relação positiva geral entre o tamanho da área floral e o sucesso de Germinação, especialmente marcado pelo menor sucesso reprodutivo  nas flores do Quartil 1, em que indivíduos com flores menores não formam nenhuma semente a partir desta flor. Já nos Quartis 2, 3 e 4 aformação de sementes foi elevada e bastante constante.



## Relação entre número de sementes e germinação

Vamos construir um boxplot para visualização das duas variáveis: "Número de Sementes" e "Germinação"

```{r}
names(df_clean)
summary(df_clean)

df_clean %>%
  mutate(quartil_nsem = ntile(nsem, 4)) %>% # divide em quartis
  ggplot(aes(x = factor(quartil_nsem), y = germ)) +
  geom_boxplot(fill="#4C72B0", alpha=.6) +
  labs(
    title = "Germinação por quartis do número de sementes",
    x = "Quartil do número de sementes",
    y = "Germinação"
  ) +
  theme_minimal()
```

- O número de sementes é um forte preditor do sucesso de Germinação. A chance de germinação é praticamente nula no quartil com o menor número de sementes (Q1). A Germinação aumenta drasticamente assim que um número mínimo de sementes é produzido. No entanto, a mediana de Germinação não aumenta linearmente com o aumento do número de sementes, mas aparenta atingir um platô, já que os quartir 3 e 4 sobrepoem as duas distribuições de taxa de germinação.
